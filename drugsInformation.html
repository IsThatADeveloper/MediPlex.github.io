<!DOCTYPE html>
<html>

<head>
  <title>Mediplex Pharmacy Library Drug Information</title>
  <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
  <link href="css/frame.css" media="screen" rel="stylesheet" type="text/css" />
	
  <link href="css/drugs.css" media="screen" rel="stylesheet" type="text/css" />

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://kit.fontawesome.com/de329c76bd.js" crossorigin="anonymous"></script>
  <script src="index.html"></script>
</head>
  
<body>
  
    <!---------------------------------Nav Bar--------------------------------->
  
    <header>
        <nav>
          <ul style="height: 25px;">
            <li class="dropdown" style="position: relative; width: 200px; height: 50px;">
              <a href="#" class="dropdown-toggle">
                <img src="img/menu.png" onclick="toggleDropdown(event)" width="25" height="25">
              </a>
              <ul class="dropdown-menu" id="dropdown-menu">
                <li style="display: block;"><a href="pages/medical.html">Medical Index</a></li>
                <li style="display: block;"><a href="pages/how_do_drugs_work.html">Information On Drugs</a></li>
                <li style="display: block;"><a href="pages/recentnews.html">Recent News</a></li>
              </ul>
            </li>
            <li style="position: absolute; left: 82px; top: -1.6%; transform: translateY(-3%);"><h2 style="color: black;"><a href="index.html">Mediplex Pharmacy</a></h2></li>
            <li style="position: absolute; right: 30px; top: 3%; transform: translateY(-3%);">
              <divnav style="display: inline-block; margin-left: 10px;">
                <a href="https://www.linkedin.com/" target="_blank" class="custom-image-button">
                  <i class="fa-brands fa-linkedin"></i>
                  <span class="hover-text">Follow us on LinkedIn</span>
                </a>
              </divnav>
              <divnav style="display: inline-block; margin-left: 10px;">
                <a href="https://www.instagram.com/" target="_blank" class="custom-image-button">
                  <i class="fa-brands fa-instagram"></i>
                  <span class="hover-text">Follow us on Instagram</span>
                </a>
              </divnav>
            </li>
          </ul>
        </nav>
    </header>
  
    
    <!---------------------------------Nav Bar End--------------------------------->
    
    <!---------------------------------Drugs--------------------------------->
    

    <section>
      <h1>Drug Name</h1>
	    
      <p><div><i class='fa-solid fa-angles-right'></i> <b>You searched for</b>: <span id="selected_drug_name"></span></div></p>
      <p><div><i class='fa-solid fa-angles-right'></i> <b>RXCUI</b>: <span id="selected_rxcui"></span></div></p>
    </section>

  
    <!---------------------------------Drugs End--------------------------------->
    
    <!---------------------------------About--------------------------------->

    <section>
      <hr class="left-aligned">
      <h1>What does the drug do (and treat) (pictures and all)</h1>
	    
      <p><div><i class='fa-solid fa-angles-right'></i> <b>RXCUI</b>: <span id="drug_info"></span></div></p>
    </section>
  
    
    <!---------------------------------About End--------------------------------->
    
    
    <!---------------------------------Usage--------------------------------->
    

    <section>
      <hr class="left-aligned">
      <h1>How is the drug used (dosage/extra info)</h1>
    </section>

    <!---------------------------------Usage End--------------------------------->
    
    
    <!---------------------------------Footer--------------------------------->
		

    <footer>
      <hr style="border: none; height: 1px; background-color: grey;" />
      <section style="color: black; padding: 100px 0 100px 0; display: flex; align-items: stretch;">
        <div>
          <i class="fa-solid fa-address-card"></i>
          <p><a href="https://www.yourpharmacy.com/reviews">About Us</a></p>
          <p><a href="https://www.yourpharmacy.com/reviews">Privacy Policy</a></p>
          <p><a href="https://www.yourpharmacy.com/reviews">Social Media</a></p>
          <br>
        </div>
        <div>
          <i class="fa-solid fa-certificate"></i>
          <p><a href="https://www.yourpharmacy.com/reviews">Partnerships</a></p>
          <p><a href="https://www.yourpharmacy.com/reviews">Reviews</a></p>
          <p><a href="https://www.yourpharmacy.com/reviews">Hours of Operation</a></p>
          <p><a href="https://www.yourpharmacy.com/shipping">Customer Service</a></p>
        </div>
      </section>
    </footer>

    <footer>
      <hr />
      <br>
      Copyright Â© 2023 MediPlexPharmacy. All rights reserved.
    </footer>

 <!---------------------------------Footer End--------------------------------->

</body>

<script>
  function toggleDropdown(event) {
    event.preventDefault();
    var dropdown = document.getElementById("dropdown-menu");
    dropdown.classList.toggle("show");
  }
  
  const selectedDrug = localStorage.getItem('selected_drug_name');
  const selectedRxcui = localStorage.getItem('selected_rxcui');
  const selectedInfo = document.getElementById('drug_info');
  
  if (selectedDrug) {
    document.getElementById('selected_drug_name').textContent = selectedDrug;
  }

  if (selectedRxcui) {
    document.getElementById('selected_rxcui').textContent = selectedRxcui;
  }
  
  const apiURL = 'https://api.fda.gov/drug/label.json?search=openfda.rxcui:' + selectedRxcui;

  const request = new XMLHttpRequest();
  request.open('GET', apiURL);
  request.onload = function() {
    if (request.status === 200) {
      const data = JSON.parse(request.responseText);
      console.log('Info:', data);
      selectedInfo.innerHTML = 'Info: ' + data;

      if (data.code === "NOT_FOUND") {
        const apiKey = 'AIzaSyD0vQjjfejlI1ztfnf-IOqgnlPSQsvXJKg'; // Replace with your actual Google API key
        const searchEngineId = '532f7ea6d2bfb4275'; // Replace with your actual Google Custom Search Engine ID
        const drugName = selectedDrug; // Replace with the drug name you want to search for

        const searchUrl = `https://www.googleapis.com/customsearch/v1?cx=${searchEngineId}&key=${apiKey}&q=${encodeURIComponent(drugName)}`;

        const searchRequest = new XMLHttpRequest();
        searchRequest.open('GET', searchUrl);
        searchRequest.onload = function() {
          if (searchRequest.status === 200) {
            const searchData = JSON.parse(searchRequest.responseText);
            // Process the search results
            if (searchData.items && searchData.items.length > 0) {
              const firstResult = searchData.items[0];
              const snippet = firstResult.snippet;
      	      selectedInfo.innerHTML = 'Drug information:' + snippet;
            } else {
      	      selectedInfo.innerHTML = 'No drug information found.';
            }
          } else {
      	    selectedInfo.innerHTML = 'An error occurred while searching for drug information:' + searchRequest.status;
          }
        };
        searchRequest.onerror = function() {
      	  selectedInfo.innerHTML = 'An error occurred while making the search request.';
        };
        searchRequest.send();
      }
    } else {
      selectedInfo.innerHTML = 'An error occurred while retrieving FDA drug label information:', request.status;
    }
  };
  request.onerror = function() {
    selectedInfo.innerHTML = 'An error occurred while making the FDA drug label request.';
  };
  request.send();
</script>

</html>
